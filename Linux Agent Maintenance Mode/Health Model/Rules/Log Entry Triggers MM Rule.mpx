<ManagementPackFragment SchemaVersion="2.0" xmlns:xsd="http://www.w3.org/2001/XMLSchema"><Monitoring>
    <Rules>
      <Rule ID="Linux.Agent.Maintenance.Mode.MMLogEntryTriggersMM.Rule" Enabled="true" Target="Linux.Agent.Maintenance.Mode.AgentMaintenanceMode.Class" ConfirmDelivery="false" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>EventCollection</Category>
        <DataSources>
          <DataSource ID="EventDS" TypeID="Unix!Microsoft.Unix.SCXLog.VarPriv.DataSource">
            <Host>$Target/Host/Property[Type="Unix!Microsoft.Unix.Computer"]/PrincipalName$</Host>
            <LogFile>/var/log/scom-agentmm.log</LogFile>
            <UserName>$RunAs[Name="Unix!Microsoft.Unix.ActionAccount"]/UserName$</UserName>
            <Password>$RunAs[Name="Unix!Microsoft.Unix.ActionAccount"]/Password$</Password>
            <RegExpFilter>START|STOP</RegExpFilter>
            <IndividualAlerts>true</IndividualAlerts>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="TriggerMMPoSh" TypeID="Linux.Agent.Maintenance.Mode.TriggerMM.WriteAction">
            <SCOMManagementServer>.</SCOMManagementServer>
            <id>$Target/Id$</id>
            <MMEvent>$Data/EventDescription$</MMEvent>
            <Separator>,</Separator>
          </WriteAction>
          <WriteAction ID="CreateEvent" TypeID="Linux.Agent.Maintenance.Mode.CreateEventFromLogFileEntry.WriteAction">
            <EventOriginId>$Target/Id$</EventOriginId>
            <PublisherId>$Target/Id$</PublisherId>
            <PublisherName>Linux Agent Maintenance Mode</PublisherName>
            <Channel>/var/log/scom-agentmm.log</Channel>
            <LoggingComputer>$Target/Host/Property[Type="Unix!Microsoft.Unix.Computer"]/PrincipalName$</LoggingComputer>
            <EventNumber>5003</EventNumber>
            <EventCategory>0</EventCategory>
            <EventLevel>0</EventLevel>
            <UserName />
            <Description>$Data/EventDescription$</Description>
          </WriteAction>
        </WriteActions>
      </Rule>
    </Rules>
  </Monitoring><LanguagePacks>
    <LanguagePack ID="ENU" IsDefault="true">
      <DisplayStrings>
        <DisplayString ElementID="Linux.Agent.Maintenance.Mode.MMLogEntryTriggersMM.Rule">
          <Name>Linux Agent Maintenance Mode - Linux Log Entry triggers Maintenance Mode Rule</Name>
          <Description>Linux Log Entry triggers Maintenance Mode Rule</Description>
        </DisplayString>
      </DisplayStrings>
      <KnowledgeArticles>
        <KnowledgeArticle ElementID="Linux.Agent.Maintenance.Mode.MMLogEntryTriggersMM.Rule" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>Rule that collects Maintenance Mode log entries in log file. Uses data from log file to start, stop, or extend maintenance mode window for the Linux computer object.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Configuration</maml:title>
              <maml:table>
                <maml:tableHeader>
                  <maml:row>
                    <maml:headerEntry>
                      <maml:para>Parameter</maml:para>
                    </maml:headerEntry>
                    <maml:headerEntry>
                      <maml:para>Default Value</maml:para>
                    </maml:headerEntry>
                    <maml:headerEntry>
                      <maml:para>Description</maml:para>
                    </maml:headerEntry>
                  </maml:row>
                </maml:tableHeader>
                <maml:row>
                  <maml:entry>
                    <maml:para>Log File</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>/var/log/scom-agentmm.log</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>Log file to monitor for Maintenance Mode entries.</maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>Separator</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>,</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>Field separator used to split log entry.</maml:para>
                  </maml:entry>
                </maml:row>
              </maml:table>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
      </KnowledgeArticles>
    </LanguagePack>
  </LanguagePacks></ManagementPackFragment>
